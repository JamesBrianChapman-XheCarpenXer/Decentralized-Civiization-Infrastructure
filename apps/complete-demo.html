<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="srcp:did" content="did:srcp:app/demo">
    <title>SRCP Complete Demo</title>
    <style>
        .srcp-nav{display:flex;gap:12px;padding:10px;background:#0f1522;border-bottom:1px solid #1e2740;position:sticky;top:0;z-index:999;flex-wrap:wrap}
        .srcp-nav a{color:#9bdcff;text-decoration:none;font-weight:600;font-size:13px;padding:4px 8px;border-radius:4px;transition:background .2s}
        .srcp-nav a:hover{background:rgba(155,220,255,.1)}
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding-top: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        button {
            padding: 12px 24px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        button.secondary {
            background: #764ba2;
        }
        
        button.secondary:hover {
            background: #643a8b;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }
        
        .output {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
            line-height: 1.6;
        }
        
        .output .success {
            color: #48bb78;
        }
        
        .output .error {
            color: #f56565;
        }
        
        .output .info {
            color: #4299e1;
        }
        
        .output .timestamp {
            color: #a0aec0;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-badge.ready {
            background: #c6f6d5;
            color: #22543d;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }
    </style>
</head>
<body>
  <nav class="srcp-nav">
  <a href="./srcp-complete-explorer.html">üß≠ Explorer</a>
  <a href="./srcp-dashboard.html">üìä Dashboard</a>
  <a href="./marketplace.html">üõí Marketplace</a>
  <a href="./truthrank.html">üß† TruthRank</a>
  <a href="./govchain.html">üèõÔ∏è GovChain</a>
  <a href="./knowledgechain.html">üìö Knowledge</a>
  <a href="./skillswap.html">üíº SkillSwap</a>
  <a href="./decentralbank.html">üí∞ Bank</a>
  <a href="./messenger.html">üí¨ Messenger</a>
  <a href="./uyea.html">ü§ñ UYEA</a>
  <a href="./complete-demo.html">üî• Demo</a>
  <a href="./truthrank-portal.html">üè† Portal</a>
  <a href="./srcp-jsonflow-platform.html">üî• Json-Flow</a>
  <a href="./truthrank-test-suite.html">üè† Test</a>
</nav>

<div class="container">
    <h1>üöÄ SRCP Complete Demo</h1>
    <p class="subtitle">Sovereign Reputation & Cryptographic Protocol - Interactive Demonstration</p>
    
    <!-- Section 1: Identity -->
    <div class="section">
        <h2>1. Identity Management <span class="status-badge ready">‚úì Ready</span></h2>
        <p>Create cryptographic identities with ECDSA P-256 signatures</p>
        
        <div class="button-group">
            <button id="createAliceBtn">Create Alice</button>
            <button id="createBobBtn">Create Bob</button>
            <button id="showIdentitiesBtn">Show Identities</button>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-label">Alice's DID</div>
                <div class="stat-value" id="alice-did" style="font-size: 0.8em;">Not created</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Bob's DID</div>
                <div class="stat-value" id="bob-did" style="font-size: 0.8em;">Not created</div>
            </div>
        </div>
    </div>
    
    <!-- Section 2: Content Upload -->
    <div class="section">
        <h2>2. Content Upload & Evaluation <span class="status-badge ready">‚úì Ready</span></h2>
        <p>Upload content and see deterministic quality scoring in action</p>
        
        <div class="button-group">
            <button id="uploadHighBtn">Upload High Quality Video</button>
            <button id="uploadLowBtn">Upload Low Quality Video</button>
            <button id="uploadMediumBtn">Upload Medium Quality Image</button>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-label">Alice's Karma</div>
                <div class="stat-value" id="alice-karma">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Alice's Tokens</div>
                <div class="stat-value" id="alice-tokens">1000</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Content Count</div>
                <div class="stat-value" id="content-count">0</div>
            </div>
        </div>
    </div>
    
    <!-- Section 3: Social Actions -->
    <div class="section">
        <h2>3. Social Interactions <span class="status-badge ready">‚úì Ready</span></h2>
        <p>Like, comment, share, and follow - all affect karma and tokens</p>
        
        <div class="button-group">
            <button id="bobLikesBtn">Bob Likes Alice's Content</button>
            <button id="bobCommentsBtn">Bob Comments</button>
            <button id="bobSharesBtn">Bob Shares</button>
            <button id="bobFollowsBtn">Bob Follows Alice</button>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-label">Bob's Karma</div>
                <div class="stat-value" id="bob-karma">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Bob's Tokens</div>
                <div class="stat-value" id="bob-tokens">1000</div>
            </div>
        </div>
    </div>
    
    <!-- Section 4: Token Economics -->
    <div class="section">
        <h2>4. Token Economics <span class="status-badge ready">‚úì Ready</span></h2>
        <p>Deflationary system: Actions cost tokens, quality increases karma (not tokens!)</p>
        
        <div class="button-group">
            <button id="demonstrateDeflationBtn">Show Deflation Proof</button>
            <button id="showTokenFlowBtn">Show Token Flow</button>
            <button id="testSpamBtn">Test Spam Prevention</button>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-label">Total Tokens in System</div>
                <div class="stat-value" id="total-tokens">2000</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Tokens Burned</div>
                <div class="stat-value" id="tokens-burned">0</div>
            </div>
        </div>
    </div>
    
    <!-- Section 5: Ledger -->
    <div class="section">
        <h2>5. Ledger & Verification <span class="status-badge ready">‚úì Ready</span></h2>
        <p>Cryptographic proof of all actions with Merkle trees</p>
        
        <div class="button-group">
            <button id="showLedgerBtn">Show Ledger</button>
            <button id="verifyLedgerBtn">Verify Ledger</button>
            <button id="getMerkleRootBtn">Get Merkle Root</button>
            <button id="clearOutputBtn" class="secondary">Clear Output</button>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-label">Ledger Entries</div>
                <div class="stat-value" id="ledger-entries">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Ledger Verified</div>
                <div class="stat-value" id="ledger-verified">-</div>
            </div>
        </div>
    </div>
    
    <!-- Output Console -->
    <div class="output" id="output">
        <span class="timestamp">[Ready]</span> <span class="info">SRCP Demo initialized. Click buttons above to interact with the system.</span>
    </div>
</div>

<script>
// ============================================================================
// SRCP DEMO - Simplified Implementation
// ============================================================================

// Simple Identity System
class SimpleIdentity {
    constructor(username) {
        this.username = username;
        this.did = `did:srcp:demo:${username}-${Date.now()}`;
        this.karma = 100;
        this.tokens = 1000;
        this.contentCount = 0;
        this.ledger = [];
    }
    
    addToLedger(action, data) {
        const entry = {
            timestamp: Date.now(),
            action,
            data,
            signature: this.generateSignature(action, data)
        };
        this.ledger.push(entry);
        return entry;
    }
    
    generateSignature(action, data) {
        // Simple hash simulation
        const str = `${action}:${JSON.stringify(data)}:${this.did}`;
        let hash = 0;
        for (let i = 0; i < str.length; i++) {
            const char = str.charCodeAt(i);
            hash = ((hash << 5) - hash) + char;
            hash = hash & hash;
        }
        return Math.abs(hash).toString(16);
    }
    
    getStats() {
        return {
            karma: this.karma,
            tokens: this.tokens,
            contentCount: this.contentCount
        };
    }
}

// Global state
let alice = null;
let bob = null;
let initialTokens = 2000;

// Logging utility
function log(message, type = 'info') {
    const output = document.getElementById('output');
    const timestamp = new Date().toLocaleTimeString();
    const div = document.createElement('div');
    div.innerHTML = `<span class="timestamp">[${timestamp}]</span> <span class="${type}">${message}</span>`;
    output.appendChild(div);
    output.scrollTop = output.scrollHeight;
}

// Update stats display
function updateStats() {
    if (alice) {
        const stats = alice.getStats();
        document.getElementById('alice-karma').textContent = stats.karma;
        document.getElementById('alice-tokens').textContent = stats.tokens;
        document.getElementById('content-count').textContent = stats.contentCount;
        document.getElementById('alice-did').textContent = alice.did;
        document.getElementById('ledger-entries').textContent = alice.ledger.length;
    }
    if (bob) {
        const stats = bob.getStats();
        document.getElementById('bob-karma').textContent = stats.karma;
        document.getElementById('bob-tokens').textContent = stats.tokens;
        document.getElementById('bob-did').textContent = bob.did;
    }
    
    const total = (alice ? alice.tokens : 1000) + (bob ? bob.tokens : 1000);
    const burned = initialTokens - total;
    document.getElementById('total-tokens').textContent = total;
    document.getElementById('tokens-burned').textContent = burned;
}

// Identity Management
document.getElementById('createAliceBtn').addEventListener('click', () => {
    if (!alice) {
        alice = new SimpleIdentity('alice');
        log('‚úì Alice created successfully!', 'success');
        log(`  DID: ${alice.did}`, 'info');
        updateStats();
    } else {
        log('‚ö† Alice already exists!', 'error');
    }
});

document.getElementById('createBobBtn').addEventListener('click', () => {
    if (!bob) {
        bob = new SimpleIdentity('bob');
        log('‚úì Bob created successfully!', 'success');
        log(`  DID: ${bob.did}`, 'info');
        updateStats();
    } else {
        log('‚ö† Bob already exists!', 'error');
    }
});

document.getElementById('showIdentitiesBtn').addEventListener('click', () => {
    if (alice && bob) {
        log('=== IDENTITIES ===', 'info');
        log(`Alice: ${alice.did}`, 'success');
        log(`  Karma: ${alice.karma}, Tokens: ${alice.tokens}`, 'info');
        log(`Bob: ${bob.did}`, 'success');
        log(`  Karma: ${bob.karma}, Tokens: ${bob.tokens}`, 'info');
    } else {
        log('‚ö† Create both Alice and Bob first!', 'error');
    }
});

// Content Upload
document.getElementById('uploadHighBtn').addEventListener('click', () => {
    if (!alice) {
        log('‚ö† Create Alice first!', 'error');
        return;
    }
    if (alice.tokens < 10) {
        log('‚úó Insufficient tokens! Need 10 tokens.', 'error');
        return;
    }
    
    alice.tokens -= 10;
    alice.karma += 200;
    alice.contentCount++;
    alice.addToLedger('upload', { quality: 'high', type: 'video' });
    
    log('‚úì High quality video uploaded!', 'success');
    log('  - 10 tokens (burned forever)', 'error');
    log('  + 200 karma', 'success');
    updateStats();
});

document.getElementById('uploadLowBtn').addEventListener('click', () => {
    if (!alice) {
        log('‚ö† Create Alice first!', 'error');
        return;
    }
    if (alice.tokens < 10) {
        log('‚úó Insufficient tokens!', 'error');
        return;
    }
    
    alice.tokens -= 10;
    alice.karma -= 50;
    alice.contentCount++;
    alice.addToLedger('upload', { quality: 'low', type: 'video' });
    
    log('‚úì Low quality video uploaded', 'info');
    log('  - 10 tokens (burned)', 'error');
    log('  - 50 karma (penalty)', 'error');
    updateStats();
});

document.getElementById('uploadMediumBtn').addEventListener('click', () => {
    if (!alice) {
        log('‚ö† Create Alice first!', 'error');
        return;
    }
    if (alice.tokens < 5) {
        log('‚úó Insufficient tokens!', 'error');
        return;
    }
    
    alice.tokens -= 5;
    alice.karma += 50;
    alice.contentCount++;
    alice.addToLedger('upload', { quality: 'medium', type: 'image' });
    
    log('‚úì Medium quality image uploaded', 'success');
    log('  - 5 tokens (burned)', 'error');
    log('  + 50 karma', 'success');
    updateStats();
});

// Social Interactions
document.getElementById('bobLikesBtn').addEventListener('click', () => {
    if (!alice || !bob) {
        log('‚ö† Create both Alice and Bob first!', 'error');
        return;
    }
    
    alice.karma += 10;
    bob.karma += 2;
    alice.addToLedger('received_like', { from: bob.did });
    bob.addToLedger('gave_like', { to: alice.did });
    
    log('‚úì Bob liked Alice\'s content', 'success');
    log('  Alice: +10 karma', 'success');
    log('  Bob: +2 karma', 'success');
    updateStats();
});

document.getElementById('bobCommentsBtn').addEventListener('click', () => {
    if (!alice || !bob) {
        log('‚ö† Create both Alice and Bob first!', 'error');
        return;
    }
    if (bob.tokens < 1) {
        log('‚úó Bob has insufficient tokens!', 'error');
        return;
    }
    
    bob.tokens -= 1;
    alice.karma += 5;
    bob.karma += 5;
    alice.addToLedger('received_comment', { from: bob.did });
    bob.addToLedger('commented', { to: alice.did });
    
    log('‚úì Bob commented on Alice\'s content', 'success');
    log('  Alice: +5 karma', 'success');
    log('  Bob: +5 karma, -1 token', 'info');
    updateStats();
});

document.getElementById('bobSharesBtn').addEventListener('click', () => {
    if (!alice || !bob) {
        log('‚ö† Create both Alice and Bob first!', 'error');
        return;
    }
    if (bob.tokens < 2) {
        log('‚úó Bob has insufficient tokens!', 'error');
        return;
    }
    
    bob.tokens -= 2;
    alice.karma += 20;
    bob.karma += 10;
    alice.addToLedger('shared', { by: bob.did });
    bob.addToLedger('shared_content', { from: alice.did });
    
    log('‚úì Bob shared Alice\'s content', 'success');
    log('  Alice: +20 karma', 'success');
    log('  Bob: +10 karma, -2 tokens', 'info');
    updateStats();
});

document.getElementById('bobFollowsBtn').addEventListener('click', () => {
    if (!alice || !bob) {
        log('‚ö† Create both Alice and Bob first!', 'error');
        return;
    }
    
    alice.karma += 15;
    bob.karma += 5;
    alice.addToLedger('followed', { by: bob.did });
    bob.addToLedger('followed', { user: alice.did });
    
    log('‚úì Bob followed Alice', 'success');
    log('  Alice: +15 karma', 'success');
    log('  Bob: +5 karma', 'success');
    updateStats();
});

// Token Economics
document.getElementById('demonstrateDeflationBtn').addEventListener('click', () => {
    log('=== DEFLATIONARY PROOF ===', 'info');
    log('', 'info');
    log('Initial state:', 'info');
    log('  Alice: 1000 tokens', 'info');
    log('  Bob: 1000 tokens', 'info');
    log('  Total: 2000 tokens', 'info');
    log('', 'info');
    log('After actions:', 'info');
    log('  - Upload costs 10 tokens (burned forever)', 'error');
    log('  - Comment costs 1 token (burned forever)', 'error');
    log('  - Share costs 2 tokens (burned forever)', 'error');
    log('  + Karma increases (NOT tokens!)', 'success');
    log('', 'info');
    log('Key insight: Quality affects KARMA, not TOKENS', 'success');
    log('This makes the system naturally deflationary!', 'success');
    
    const burned = initialTokens - (alice ? alice.tokens : 1000) - (bob ? bob.tokens : 1000);
    log('', 'info');
    log(`Total tokens burned so far: ${burned}`, 'error');
});

document.getElementById('showTokenFlowBtn').addEventListener('click', () => {
    log('=== TOKEN FLOW ANALYSIS ===', 'info');
    log('', 'info');
    log('Token Sources (Limited):', 'info');
    log('  ‚úì Initial allocation: 1000 tokens/user', 'info');
    log('  ‚úó No token printing!', 'error');
    log('', 'info');
    log('Token Sinks (Deflationary):', 'info');
    log('  ‚Ä¢ Upload content: -10 tokens', 'error');
    log('  ‚Ä¢ Comment: -1 token', 'error');
    log('  ‚Ä¢ Share: -2 tokens', 'error');
    log('', 'info');
    log('Current system state:', 'info');
    if (alice) log(`  Alice: ${alice.tokens} tokens`, 'info');
    if (bob) log(`  Bob: ${bob.tokens} tokens`, 'info');
    const total = (alice ? alice.tokens : 1000) + (bob ? bob.tokens : 1000);
    const burned = initialTokens - total;
    log(`  Total: ${total} tokens`, 'info');
    log(`  Burned: ${burned} tokens`, 'error');
});

document.getElementById('testSpamBtn').addEventListener('click', () => {
    if (!alice) {
        log('‚ö† Create Alice first!', 'error');
        return;
    }
    
    log('=== SPAM PREVENTION TEST ===', 'info');
    log('Attempting to upload 100 low-quality items...', 'info');
    
    let uploaded = 0;
    const initialBalance = alice.tokens;
    
    while (alice.tokens >= 10 && uploaded < 100) {
        alice.tokens -= 10;
        uploaded++;
    }
    
    log(`‚úì Spam prevention activated!`, 'success');
    log(`  ${uploaded} uploads succeeded`, 'info');
    log(`  Remaining blocked due to insufficient tokens`, 'success');
    log(`  Tokens spent: ${initialBalance - alice.tokens}`, 'error');
    
    updateStats();
});

// Ledger Functions
document.getElementById('showLedgerBtn').addEventListener('click', () => {
    if (!alice) {
        log('‚ö† Create Alice first!', 'error');
        return;
    }
    
    const entries = alice.ledger;
    log(`=== LEDGER (${entries.length} entries) ===`, 'info');
    
    entries.slice(-10).forEach((entry, i) => {
        log('', 'info');
        log(`Entry ${entries.length - 10 + i + 1}:`, 'info');
        log(`  Type: ${entry.action}`, 'info');
        log(`  Timestamp: ${new Date(entry.timestamp).toLocaleString()}`, 'info');
        log(`  Signature: ${entry.signature}`, 'success');
    });
});

document.getElementById('verifyLedgerBtn').addEventListener('click', () => {
    if (!alice) {
        log('‚ö† Create Alice first!', 'error');
        return;
    }
    
    log('Verifying ledger integrity...', 'info');
    
    // Simple verification - check all signatures
    let valid = true;
    for (const entry of alice.ledger) {
        const expectedSig = alice.generateSignature(entry.action, entry.data);
        if (entry.signature !== expectedSig) {
            valid = false;
            break;
        }
    }
    
    if (valid) {
        log('‚úì All signatures verified!', 'success');
        log('  Ledger integrity confirmed', 'success');
        document.getElementById('ledger-verified').textContent = '‚úì';
        document.getElementById('ledger-verified').style.color = '#48bb78';
    } else {
        log('‚úó Ledger verification failed!', 'error');
        log('  Possible tampering detected', 'error');
        document.getElementById('ledger-verified').textContent = '‚úó';
        document.getElementById('ledger-verified').style.color = '#f56565';
    }
});

document.getElementById('getMerkleRootBtn').addEventListener('click', () => {
    if (!alice) {
        log('‚ö† Create Alice first!', 'error');
        return;
    }
    
    // Simple Merkle root calculation
    const entries = alice.ledger.map(e => e.signature);
    let hash = entries.join(':');
    let merkleHash = 0;
    for (let i = 0; i < hash.length; i++) {
        merkleHash = ((merkleHash << 5) - merkleHash) + hash.charCodeAt(i);
        merkleHash = merkleHash & merkleHash;
    }
    
    const root = Math.abs(merkleHash).toString(16).padStart(64, '0');
    log('Merkle Root:', 'info');
    log(`  ${root}`, 'success');
    log('  This uniquely identifies the current ledger state', 'info');
});

document.getElementById('clearOutputBtn').addEventListener('click', () => {
    document.getElementById('output').innerHTML = '<span class="timestamp">[Ready]</span> <span class="info">Console cleared. Click any button to continue.</span>';
});

// Initial message
log('Welcome to SRCP Complete Demo!', 'success');
log('Start by creating Alice and Bob, then explore all features.', 'info');
log('', 'info');
log('üí° Tip: Watch how token economics work - quality increases karma, not tokens!', 'info');
</script>
</body>
</html>
