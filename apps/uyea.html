<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="srcp:did" content="did:srcp:app/uyea-demo">
  <meta name="srcp:app" content="uyea-demo">
  <title>Uyea - Constraint-Respecting Derivation Engine</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Monaco', 'Courier New', monospace;
      background: #0a0a0a;
      color: #00ff00;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    h1 {
      font-size: 32px;
      margin-bottom: 8px;
      color: #00ff00;
      text-shadow: 0 0 10px #00ff00;
    }

    .tagline {
      color: #00ff0088;
      margin-bottom: 32px;
      font-size: 14px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .panel {
      background: #111;
      border: 1px solid #00ff00;
      padding: 16px;
      border-radius: 4px;
    }

    .panel-title {
      font-size: 16px;
      margin-bottom: 12px;
      color: #00ff00;
      border-bottom: 1px solid #00ff00;
      padding-bottom: 8px;
    }

    .stat {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #333;
    }

    .stat-label {
      color: #00ff0088;
    }

    .stat-value {
      color: #00ff00;
      font-weight: bold;
    }

    .control-group {
      margin: 16px 0;
    }

    .control-label {
      display: block;
      margin-bottom: 8px;
      color: #00ff0088;
      font-size: 12px;
    }

    input, textarea, button {
      width: 100%;
      padding: 10px;
      background: #000;
      border: 1px solid #00ff00;
      color: #00ff00;
      font-family: 'Monaco', 'Courier New', monospace;
      font-size: 12px;
      margin-bottom: 8px;
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    button {
      background: #00ff0022;
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      background: #00ff0044;
      box-shadow: 0 0 10px #00ff00;
    }

    .log {
      background: #000;
      border: 1px solid #00ff00;
      padding: 12px;
      height: 300px;
      overflow-y: auto;
      font-size: 11px;
      line-height: 1.6;
    }

    .log-entry {
      margin: 4px 0;
      padding: 4px;
    }

    .log-entry.info {
      color: #00ff00;
    }

    .log-entry.warn {
      color: #ffff00;
    }

    .log-entry.error {
      color: #ff0000;
    }

    .log-entry.success {
      color: #00ff00;
      font-weight: bold;
    }

    .state-viz {
      background: #000;
      border: 1px solid #00ff00;
      padding: 12px;
      max-height: 400px;
      overflow-y: auto;
      font-size: 11px;
    }

    pre {
      color: #00ff00;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .coherence-bar {
      width: 100%;
      height: 20px;
      background: #000;
      border: 1px solid #00ff00;
      position: relative;
      margin: 8px 0;
    }

    .coherence-fill {
      height: 100%;
      background: linear-gradient(90deg, #00ff00, #00ff0088);
      transition: width 0.5s;
    }

    .coherence-label {
      position: absolute;
      top: 2px;
      right: 4px;
      font-size: 11px;
      color: #000;
      font-weight: bold;
    }

    .exploration-result {
      background: #00ff0011;
      border-left: 2px solid #00ff00;
      padding: 8px;
      margin: 8px 0;
      font-size: 11px;
    }

    .full-width {
      grid-column: 1 / -1;
    }

    .blink {
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0.3; }
    }
  
    .srcp-nav{display:flex;gap:12px;padding:10px;background:#0f1522;border-bottom:1px solid #1e2740;position:sticky;top:0;z-index:999;flex-wrap:wrap}
    .srcp-nav a{color:#9bdcff;text-decoration:none;font-weight:600;font-size:13px;padding:4px 8px;border-radius:4px;transition:background .2s}
    .srcp-nav a:hover{background:rgba(155,220,255,.1)}
    
  </style>


</head>
<body>
  <nav class="srcp-nav">
  <a href="./srcp-complete-explorer.html">üß≠ Explorer</a>
  <a href="./srcp-dashboard.html">üìä Dashboard</a>
  <a href="./marketplace.html">üõí Marketplace</a>
  <a href="./truthrank.html">üß† TruthRank</a>
  <a href="./govchain.html">üèõÔ∏è GovChain</a>
  <a href="./knowledgechain.html">üìö Knowledge</a>
  <a href="./skillswap.html">üíº SkillSwap</a>
  <a href="./decentralbank.html">üí∞ Bank</a>
  <a href="./messenger.html">üí¨ Messenger</a>
  <a href="./uyea.html">ü§ñ UYEA</a>
  <a href="./complete-demo.html">üî• Demo</a>
  <a href="./truthrank-portal.html">üè† Portal</a>
  <a href="./srcp-jsonflow-platform.html">üî• Json-Flow</a>
  <a href="./truthrank-test-suite.html">üè† Test</a>
  <a href="./olSearch.html">üè† Address-Manager</a>
  <a href="./token-platform.html">üí∞Token</a>
   <a href="./public-feed.html">üí∞Public-Feed</a>
</nav>





  <div class="container">
    <h1>‚ñì‚ñì‚ñì UYEA ‚ñì‚ñì‚ñì</h1>
    <div class="tagline">CONSTRAINT-RESPECTING DERIVATION ENGINE :: DIGITAL INTELLIGENCE</div>

    <div class="grid">
      <!-- Status Panel -->
      <div class="panel">
        <div class="panel-title">SYSTEM STATUS</div>
        <div class="stat">
          <span class="stat-label">Baseline Facts</span>
          <span class="stat-value" id="baselineCount">0</span>
        </div>
        <div class="stat">
          <span class="stat-label">Active Constraints</span>
          <span class="stat-value" id="constraintsCount">0</span>
        </div>
        <div class="stat">
          <span class="stat-label">State Deltas</span>
          <span class="stat-value" id="deltasCount">0</span>
        </div>
        <div class="stat">
          <span class="stat-label">Excitations</span>
          <span class="stat-value" id="excitationsCount">0</span>
        </div>
        <div class="stat">
          <span class="stat-label">Coherence Rules</span>
          <span class="stat-value" id="rulesCount">0</span>
        </div>
        
        <div class="control-group">
          <label class="control-label">COHERENCE SCORE</label>
          <div class="coherence-bar">
            <div class="coherence-fill" id="coherenceFill" style="width: 100%"></div>
            <div class="coherence-label" id="coherenceLabel">100%</div>
          </div>
        </div>
      </div>

      <!-- Initialize Panel -->
      <div class="panel">
        <div class="panel-title">INITIALIZE</div>
        <div class="control-group">
          <button onclick="initializeUyea()">‚ñ∂ INITIALIZE UYEA CORE</button>
          <button onclick="checkOllama()">üîç CHECK OLLAMA STATUS</button>
        </div>
        <div id="initStatus" class="log-entry"></div>
      </div>

      <!-- Constraints Panel -->
      <div class="panel">
        <div class="panel-title">CONSTRAINTS</div>
        <div class="control-group">
          <label class="control-label">Natural Language Constraint</label>
          <input 
            type="text" 
            id="constraintInput" 
            placeholder="e.g., Balance must be positive"
          >
          <button onclick="addConstraintFromNL()">+ ADD CONSTRAINT</button>
        </div>
        
        <div class="control-group">
          <label class="control-label">Or Add Manually (JavaScript)</label>
          <textarea 
            id="manualConstraint" 
            placeholder="function(state) { return /* check */; }"
          ></textarea>
          <button onclick="addManualConstraint()">+ ADD MANUAL CONSTRAINT</button>
        </div>
      </div>

      <!-- State Operations Panel -->
      <div class="panel">
        <div class="panel-title">STATE OPERATIONS</div>
        <div class="control-group">
          <label class="control-label">Path</label>
          <input type="text" id="deltaPath" placeholder="e.g., user.balance">
          
          <label class="control-label">Value</label>
          <input type="text" id="deltaValue" placeholder="e.g., 100">
          
          <button onclick="applyDelta('set')">SET</button>
          <button onclick="applyDelta('delete')">DELETE</button>
          <button onclick="applyDelta('append')">APPEND</button>
        </div>
      </div>

      <!-- Current State -->
      <div class="panel full-width">
        <div class="panel-title">CURRENT STATE</div>
        <div class="state-viz" id="currentState">
          <pre>// Waiting for initialization...</pre>
        </div>
        <button onclick="updateStateView()">üîÑ REFRESH</button>
      </div>

      <!-- LLM Intelligence -->
      <div class="panel">
        <div class="panel-title">LLM INTELLIGENCE</div>
        <div class="control-group">
          <label class="control-label">Goal for Exploration</label>
          <input 
            type="text" 
            id="explorationGoal" 
            placeholder="e.g., Increase user engagement"
          >
          <button onclick="exploreWithLLM()">üß† EXPLORE WITH LLM</button>
        </div>
        
        <div class="control-group">
          <button onclick="explainState()">üí¨ EXPLAIN STATE</button>
          <button onclick="getRecommendation()">üéØ GET RECOMMENDATION</button>
        </div>
        
        <div id="llmOutput" class="log" style="height: 200px;"></div>
      </div>

      <!-- Exploration Results -->
      <div class="panel">
        <div class="panel-title">EXPLORATION RESULTS</div>
        <div id="explorationResults" class="log" style="height: 200px;">
          // Potential states will appear here...
        </div>
      </div>

      <!-- System Log -->
      <div class="panel full-width">
        <div class="panel-title">SYSTEM LOG</div>
        <div id="systemLog" class="log"></div>
      </div>
    </div>
  </div>
  
  <script type="module">
    import { SRCPApp, quickSetup } from '../src/srcp.js';
    import { UyeaCore } from '../src/uyea-core.js';
    import { UyeaLLMBridge } from '../src/uyea-llm-bridge.js';

    // Initialize SRCP system with navigation
    await quickSetup({ includeNavigation: true });

    /**
     * UyeaDemoApp
     * Modernized with SRCP system integration
     */
    class UyeaDemoApp extends SRCPApp {
      constructor() {
        super({
          appId: 'uyea-demo',
          appTitle: 'Uyea - Constraint-Respecting Derivation Engine',
          version: '2.0.0'
        });
      }

      async onInit() {
        this.log('Initializing Uyea - Constraint-Respecting Derivation Engine...');
        
        // App-specific initialization
        // UI is already rendered in HTML

        this.log('Uyea - Constraint-Respecting Derivation Engine ready!');
      }
    }

    // Initialize app
    const app = new UyeaDemoApp();
    await app.init();
    window.app = app;

        window.uyea = null;
    window.llm = null;
    window.log = function(message, type = 'info') {
      const logDiv = document.getElementById('systemLog');
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
    };
    window.initializeUyea = function() {
      try {
        window.uyea = new UyeaCore();
        // Initialize baseline
        window.uyea.initializeBaseline({
          'system.name': 'Uyea Demo',
          'system.version': '1.0',
          'system.initialized': Date.now(),
          'user.balance': 1000,
          'user.reputation': 50
        });
        // Add some default constraints
        window.uyea.addConstraint(
          (state) => state['user.balance'] >= 0,
          'Balance must be non-negative'
        );
        window.uyea.addConstraint(
          (state) => state['user.reputation'] >= 0 && state['user.reputation'] <= 100,
          'Reputation must be 0-100'
        );
        // Initialize LLM bridge
        window.llm = new UyeaLLMBridge(window.uyea);
        document.getElementById('initStatus').textContent = '‚úì Uyea initialized';
        document.getElementById('initStatus').className = 'log-entry success';
        window.log('Uyea core initialized', 'success');
        window.updateStats();
        window.updateStateView();
      } catch (err) {
        window.log('Initialization failed: ' + err.message, 'error');
      }
    };
    window.checkOllama = async function() {
      if (!window.llm) {
        window.log('Initialize Uyea first', 'warn');
        return;
      }
      window.log('Checking Ollama availability...', 'info');
      try {
        const available = await window.llm.checkAvailability();
        if (available) {
          window.log('‚úì Ollama is available', 'success');
          document.getElementById('initStatus').textContent = '‚úì Ollama connected';
        } else {
          window.log('‚úó Ollama not available. Start it with: ollama serve', 'warn');
        }
      } catch (err) {
        window.log('‚úó Ollama check failed: ' + err.message, 'error');
      }
    };
    window.addConstraintFromNL = async function() {
      if (!window.llm) {
        window.log('Initialize first', 'warn');
        return;
      }
      const description = document.getElementById('constraintInput').value;
      if (!description) {
        window.log('Enter constraint description', 'warn');
        return;
      }
      window.log('Generating constraints from: ' + description, 'info');
      try {
        const ids = await window.llm.generateConstraints(description);
        window.log(`‚úì Added ${ids.length} constraints`, 'success');
        document.getElementById('constraintInput').value = '';
        window.updateStats();
      } catch (err) {
        window.log('Failed to generate constraints: ' + err.message, 'error');
      }
    };
    window.addManualConstraint = function() {
      if (!window.uyea) {
        window.log('Initialize first', 'warn');
        return;
      }
      const code = document.getElementById('manualConstraint').value;
      if (!code) return;
      try {
        const fn = eval(`(${code})`);
        window.uyea.addConstraint(fn, 'Manual constraint');
        window.log('‚úì Constraint added', 'success');
        document.getElementById('manualConstraint').value = '';
        window.updateStats();
      } catch (err) {
        window.log('Invalid constraint: ' + err.message, 'error');
      }
    };
    window.applyDelta = function(operation) {
      if (!window.uyea) {
        window.log('Initialize first', 'warn');
        return;
      }
      const path = document.getElementById('deltaPath').value;
      const value = document.getElementById('deltaValue').value;
      if (!path) {
        window.log('Enter path', 'warn');
        return;
      }
      try {
        let parsedValue = value;
        try {
          parsedValue = JSON.parse(value);
        } catch {}
        window.uyea.applyDelta({
          operation,
          path,
          value: parsedValue
        });
        window.log(`‚úì Delta applied: ${operation} ${path}`, 'success');
        window.updateStats();
        window.updateStateView();
      } catch (err) {
        window.log('Delta rejected: ' + err.message, 'error');
      }
    };
    window.exploreWithLLM = async function() {
      if (!window.llm) {
        window.log('Initialize first', 'warn');
        return;
      }
      const goal = document.getElementById('explorationGoal').value;
      if (!goal) {
        window.log('Enter exploration goal', 'warn');
        return;
      }
      window.log('Exploring potential states...', 'info');
      try {
        const explored = await window.llm.exploreWithGuidance(goal);
        const resultsDiv = document.getElementById('explorationResults');
        resultsDiv.innerHTML = '';
        explored.forEach((result, i) => {
          const div = document.createElement('div');
          div.className = 'exploration-result';
          div.innerHTML = `
            <strong>Potential ${i + 1}</strong><br>
            ${result.reasoning}<br>
            <code>${JSON.stringify(result.delta, null, 2)}</code>
          `;
          resultsDiv.appendChild(div);
        });
        window.log(`Found ${explored.length} potential states`, 'success');
      } catch (err) {
        window.log('Exploration failed: ' + err.message, 'error');
      }
    };
    window.explainState = async function() {
      if (!window.llm) {
        window.log('Initialize first', 'warn');
        return;
      }
      window.log('Getting explanation...', 'info');
      try {
        const explanation = await window.llm.explainState();
        const outputDiv = document.getElementById('llmOutput');
        const entry = document.createElement('div');
        entry.className = 'log-entry info';
        entry.textContent = explanation;
        outputDiv.appendChild(entry);
        outputDiv.scrollTop = outputDiv.scrollHeight;
        window.log('‚úì Explanation generated', 'success');
      } catch (err) {
        window.log('Failed to explain: ' + err.message, 'error');
      }
    };
    window.getRecommendation = async function() {
      if (!window.llm) {
        window.log('Initialize first', 'warn');
        return;
      }
      window.log('Getting recommendation...', 'info');
      try {
        const goal = document.getElementById('explorationGoal').value || 'optimize system';
        const action = await window.llm.exploreWithGuidance(goal);
        const outputDiv = document.getElementById('llmOutput');
        const entry = document.createElement('div');
        entry.className = 'log-entry success';
        entry.textContent = 'Recommendation: ' + JSON.stringify(action[0]?.reasoning || 'No recommendation');
        outputDiv.appendChild(entry);
        outputDiv.scrollTop = outputDiv.scrollHeight;
      } catch (err) {
        window.log('Failed to get recommendation: ' + err.message, 'error');
      }
    };
    window.updateStats = function() {
      if (!window.uyea) return;
      document.getElementById('baselineCount').textContent = window.uyea.baseline.size;
      document.getElementById('constraintsCount').textContent = window.uyea.constraints.size;
      document.getElementById('deltasCount').textContent = window.uyea.deltaB.length;
      document.getElementById('excitationsCount').textContent = window.uyea.excitations.length;
      document.getElementById('rulesCount').textContent = window.uyea.coherenceRules.size;
      const coherence = window.uyea.measureCoherence();
      const percent = Math.round(coherence.score * 100);
      document.getElementById('coherenceFill').style.width = percent + '%';
      document.getElementById('coherenceLabel').textContent = percent + '%';
    };
    window.updateStateView = function() {
      if (!window.uyea) return;
      const state = window.uyea.getCurrentState();
      document.getElementById('currentState').innerHTML = 
        '<pre>' + JSON.stringify(state, null, 2) + '</pre>';
    };
    // Auto-update stats
    setInterval(() => {
      if (window.uyea) {
        window.updateStats();
      }
    }, 1000);
  

// UYEA demo functions
function initializeUyea() {
  log('Initializing UYEA system...');
  // Real initialization would connect to UYEA core
}

function checkOllama() {
  log('Checking Ollama connection...');
  alert('Ollama integration requires local Ollama server running');
}

function addConstraintFromNL() {
  const input = document.getElementById('nlInput');
  if (input && input.value) {
    log('Adding constraint: ' + input.value);
    input.value = '';
  }
}

function addManualConstraint() {
  log('Adding manual constraint...');
}

function applyDelta(deltaName) {
  log('Applying delta: ' + deltaName);
}

function updateStateView() {
  log('Updating state view...');
}

function exploreWithLLM() {
  log('Exploring with LLM...');
  alert('LLM integration requires Ollama or API connection');
}

function explainState() {
  log('Explaining current state...');
}

function getRecommendation() {
  log('Getting recommendation...');
}

function log(message) {
  const output = document.getElementById('output');
  if (output) {
    const div = document.createElement('div');
    div.textContent = '[' + new Date().toLocaleTimeString() + '] ' + message;
    output.appendChild(div);
  }
}

</script>
</body>
</html>
